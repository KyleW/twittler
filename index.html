<!DOCTYPE html>
<html>
<head>
	<script src="jquery.js"></script>
	<script src="data_generator.js"></script>
	<link href="styles.css" rel="stylesheet">
</head>
<body>
	<h2>Timeline</h2>
	<div id='timeline'></div>
	<br>
	<h2>Tweets</h2>
	<div id='main'></div>
	<br>
	<button>Check for more tweets</button>

	<script>
		var getTweet = function(index,location,prepend){
			    var tweet = streams.home[index];
      		var $tweet = $('<div class="tweet"></div>');
      		$tweet.text('@' + tweet.user + ': ' + tweet.message+' ['+tweet.created_at+"]").data({'user':tweet.user});    	  
      		if (prepend){
 	      		$tweet.prependTo(location);

      		} else {
      			$tweet.appendTo(location);
      		}

		};


		$(document).ready(function(){

      	//Given JS to display list of tweets
      	var $body = $('#main');
      	$body.html('');
      	var index = streams.home.length - 1;
      	while(index >= 0){
      		getTweet(index,$body);
      		index -= 1;
      	}

        // Display new tweets after page is loadded on button press
        $('button').on('click',function(){
        	debugger;
        	var current = $('#main div').length;
        	var available = streams.home.length; 
        	if (current < available){
		      	while(current < available){
		      		getTweet(current,$body,1);
		      		current += 1;
		      	}
        	}
        });

        // Clicking on a tweet
        $('#main').on('click','div',function(){
      	  var tlUser = $(this).data("user");
      	  var $timeline = $('#timeline');
      	  $timeline.html('');
      	  var index = streams.home.length - 1;
	      	while(index >= 0){
	      		var tweet = streams.home[index];
	      		if (tweet.user === tlUser){
  	      		getTweet(index,$timeline);		
	      		}
	      		index -= 1;
	      	}      	
      	});
      });

			


</script>


</body>
</html>
